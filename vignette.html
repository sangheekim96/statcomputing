<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Sanghee Kim" />

<meta name="date" content="2022-12-09" />

<title>MLAclass</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MLAclass</h1>
<h4 class="author">Sanghee Kim</h4>
<h4 class="date">2022-12-09</h4>



<div id="installing-all-packages-needed" class="section level2">
<h2>Installing all packages needed</h2>
<p>You can download the <code>MLAclass</code> package by
devtools::install_github function. <code>MLAclass</code> package
contains the functions that fit each model on the high-frequency data.
The models are Elatic-Net penalized logistic regression, gradient
boosting, random forest, and feed-forward neural network.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;sangheekim96/statcomputing/MLAclass&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&#39;pROC&#39;</span>, <span class="st">&#39;glmnet&#39;</span>, <span class="st">&#39;gbm&#39;</span>, <span class="st">&#39;randomForest&#39;</span>, <span class="st">&#39;neuralnet&#39;</span>, <span class="st">&#39;ggplot2&#39;</span>, <span class="st">&#39;RColorBrewer&#39;</span>, <span class="st">&#39;stringer&#39;</span>, <span class="st">&#39;dplyr&#39;</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neuralnet)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLAclass)</span></code></pre></div>
</div>
<div id="downloading-the-data" class="section level2">
<h2>Downloading the data</h2>
<p>The data used for this analysis is stored in data folder. After
downloading it to your computer and setting the appropriate working
directory, you may use load function as below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;average_measures_for_financials_Deciles_1_and_7.RData&quot;</span>)</span></code></pre></div>
</div>
<div id="description-of-mlaclass-package" class="section level2">
<h2>Description of <code>MLAclass</code> package</h2>
<p>The <code>MLAclass</code> package consists of 10
functions-purged.cross.validation, PLResults_min, PLResults_1se,
GBResults, RFresult, NN1result, NN3result, NN3result, NN4result,
NN5result.<code>purged.cross.validation</code> function does purged
cross validation on the preprocessed data by adding some data points
before and after our selected test interval. each result function prints
a list of predicted sign of realized volatility and kurtosis. If cross
features are considered, there will be 6 features to predict the
response variable and if cross features are not considered, only 3
features will be used to predict.</p>
</div>
<div id="data-preprocessing" class="section level2">
<h2>Data preprocessing</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(avgMeasures[,<span class="sc">-</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">22</span>)])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> avgMeasures[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">17</span><span class="sc">:</span><span class="dv">18</span>)]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>musigma11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Big</span><span class="st">`</span>)<span class="sc">+</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Big</span><span class="st">`</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>musigma12 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Big</span><span class="st">`</span>)<span class="sc">-</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Big</span><span class="st">`</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>musigma21 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Small</span><span class="st">`</span>)<span class="sc">+</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Small</span><span class="st">`</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>musigma22 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Small</span><span class="st">`</span>)<span class="sc">-</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Real Vol.Small</span><span class="st">`</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>musigma31 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Big</span><span class="st">`</span>)<span class="sc">+</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Big</span><span class="st">`</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>musigma32 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Big</span><span class="st">`</span>)<span class="sc">-</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Big</span><span class="st">`</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>musigma41 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Small</span><span class="st">`</span>)<span class="sc">+</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Small</span><span class="st">`</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>musigma42 <span class="ot">&lt;-</span> <span class="fu">mean</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Small</span><span class="st">`</span>)<span class="sc">-</span><span class="fu">sd</span>(val<span class="sc">$</span><span class="st">`</span><span class="at">Change Kurtosis.Small</span><span class="st">`</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> <span class="fu">transform</span>(val, <span class="st">&#39;Sign Real Vol.Big&#39;</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Real Vol.Big</span><span class="st">`</span> <span class="sc">&lt;</span> musigma12, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                                                             <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Real Vol.Big</span><span class="st">`</span> <span class="sc">&gt;</span> musigma11, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Sign Real Vol.Small&#39;</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Real Vol.Small</span><span class="st">`</span> <span class="sc">&lt;</span> musigma22, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Real Vol.Small</span><span class="st">`</span> <span class="sc">&gt;</span> musigma21, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Sign Kurtosis.Big&#39;</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Kurtosis.Big</span><span class="st">`</span> <span class="sc">&lt;</span> musigma32, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Kurtosis.Big</span><span class="st">`</span> <span class="sc">&gt;</span> musigma31, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Sign Kurtosis.Small&#39;</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Kurtosis.Small</span><span class="st">`</span> <span class="sc">&lt;</span> musigma42, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Change Kurtosis.Small</span><span class="st">`</span> <span class="sc">&gt;</span> musigma41, <span class="dv">1</span>, <span class="dv">0</span>))))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(new, val[,<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])</span></code></pre></div>
</div>
<div id="fit-each-ml-model" class="section level2">
<h2>Fit each ML model</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plRes_min <span class="ot">&lt;-</span> <span class="fu">PLResults_min</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plRes_1se <span class="ot">&lt;-</span> <span class="fu">PLResults_1se</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>gbRes <span class="ot">&lt;-</span> <span class="fu">GBResults</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>rfRes <span class="ot">&lt;-</span> <span class="fu">RFresult</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>nn1Res <span class="ot">&lt;-</span> <span class="fu">NN1result</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>nn2Res <span class="ot">&lt;-</span> <span class="fu">NN2result</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>nn3Res <span class="ot">&lt;-</span> <span class="fu">NN3result</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>nn4Res <span class="ot">&lt;-</span> <span class="fu">NN4result</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>nn5Res <span class="ot">&lt;-</span> <span class="fu">NN5result</span>(new, <span class="at">featuresBase =</span> <span class="fu">c</span>(<span class="st">&quot;Roll&quot;</span>, <span class="st">&quot;Amihud&quot;</span>, <span class="st">&quot;VPIN&quot;</span>))</span></code></pre></div>
</div>
<div id="plot-roc-curves" class="section level2">
<h2>Plot ROC curves</h2>
<p>For each ML model, ROC curves are plotted for 8 different
scenarios.</p>
<ol style="list-style-type: lower-roman">
<li>Predicting the sign of realized volatility for large firms - no
CE</li>
<li>Predicting the sign of realized volatility for large firms - CE</li>
<li>Predicting the sign of realized volatility for small firms - no
CE</li>
<li>Predicting the sign of realized volatility for small firms - CE</li>
<li>Predicting the sign of kurtosis for large firms - no CE</li>
<li>Predicting the sign of krutosis for large firms - CE</li>
<li>Predicting the sign of kurtosis for small firms - no CE</li>
<li>Predicting the sign of krutosis for small firms - CE</li>
</ol>
<p>Hence there will be 72 ROC curves printed.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">############ 1. elastic net penalized logistic lambda.min</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_min<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.min&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a><span class="do">############ 2. elastic net penalized logistic lambda.1se</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plRes_1se<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;PL lambda.1se&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a><span class="do">############ 3. gradient boosting</span></span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, gbRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;GB&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a><span class="do">############ 4. random forest</span></span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rfRes<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;RF&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;Predicting Kurtosis for Small Firms </span><span class="sc">\n</span><span class="st">w/ cross-features&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a><span class="do">############ 5. neural network 1</span></span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a><span class="do">##no CE &amp; CE compare</span></span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (noCE) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>)),</span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (CE) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))),</span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn1Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN1&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-533"><a href="#cb5-533" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-534"><a href="#cb5-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-535"><a href="#cb5-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-536"><a href="#cb5-536" aria-hidden="true" tabindex="-1"></a><span class="do">############ 6. neural network 2</span></span>
<span id="cb5-537"><a href="#cb5-537" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-538"><a href="#cb5-538" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-539"><a href="#cb5-539" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-540"><a href="#cb5-540" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-541"><a href="#cb5-541" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-542"><a href="#cb5-542" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-543"><a href="#cb5-543" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-544"><a href="#cb5-544" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-545"><a href="#cb5-545" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-546"><a href="#cb5-546" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-547"><a href="#cb5-547" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-548"><a href="#cb5-548" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-549"><a href="#cb5-549" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-550"><a href="#cb5-550" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-551"><a href="#cb5-551" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-552"><a href="#cb5-552" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-553"><a href="#cb5-553" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-554"><a href="#cb5-554" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-555"><a href="#cb5-555" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-556"><a href="#cb5-556" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-557"><a href="#cb5-557" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-558"><a href="#cb5-558" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-559"><a href="#cb5-559" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-560"><a href="#cb5-560" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-561"><a href="#cb5-561" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-562"><a href="#cb5-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-563"><a href="#cb5-563" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-564"><a href="#cb5-564" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-565"><a href="#cb5-565" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-566"><a href="#cb5-566" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-567"><a href="#cb5-567" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-568"><a href="#cb5-568" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-569"><a href="#cb5-569" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-570"><a href="#cb5-570" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-571"><a href="#cb5-571" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-572"><a href="#cb5-572" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-573"><a href="#cb5-573" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-574"><a href="#cb5-574" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-575"><a href="#cb5-575" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-576"><a href="#cb5-576" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-577"><a href="#cb5-577" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-578"><a href="#cb5-578" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-579"><a href="#cb5-579" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-580"><a href="#cb5-580" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-581"><a href="#cb5-581" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-582"><a href="#cb5-582" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-583"><a href="#cb5-583" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-584"><a href="#cb5-584" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-585"><a href="#cb5-585" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-586"><a href="#cb5-586" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-587"><a href="#cb5-587" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-588"><a href="#cb5-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-589"><a href="#cb5-589" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-590"><a href="#cb5-590" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-591"><a href="#cb5-591" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-592"><a href="#cb5-592" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-593"><a href="#cb5-593" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-594"><a href="#cb5-594" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-595"><a href="#cb5-595" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-596"><a href="#cb5-596" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-597"><a href="#cb5-597" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-598"><a href="#cb5-598" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-599"><a href="#cb5-599" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-600"><a href="#cb5-600" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-601"><a href="#cb5-601" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-602"><a href="#cb5-602" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-603"><a href="#cb5-603" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-604"><a href="#cb5-604" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-605"><a href="#cb5-605" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-606"><a href="#cb5-606" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-607"><a href="#cb5-607" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-608"><a href="#cb5-608" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-609"><a href="#cb5-609" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-610"><a href="#cb5-610" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-611"><a href="#cb5-611" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-612"><a href="#cb5-612" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-613"><a href="#cb5-613" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-614"><a href="#cb5-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-615"><a href="#cb5-615" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-616"><a href="#cb5-616" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-617"><a href="#cb5-617" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn2Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-618"><a href="#cb5-618" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-619"><a href="#cb5-619" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-620"><a href="#cb5-620" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-621"><a href="#cb5-621" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-622"><a href="#cb5-622" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-623"><a href="#cb5-623" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-624"><a href="#cb5-624" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-625"><a href="#cb5-625" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-626"><a href="#cb5-626" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-627"><a href="#cb5-627" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-628"><a href="#cb5-628" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-629"><a href="#cb5-629" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-630"><a href="#cb5-630" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-631"><a href="#cb5-631" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-632"><a href="#cb5-632" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-633"><a href="#cb5-633" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN2&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-634"><a href="#cb5-634" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-635"><a href="#cb5-635" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-636"><a href="#cb5-636" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-637"><a href="#cb5-637" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-638"><a href="#cb5-638" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-639"><a href="#cb5-639" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-640"><a href="#cb5-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-641"><a href="#cb5-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-642"><a href="#cb5-642" aria-hidden="true" tabindex="-1"></a><span class="do">############ 7. neural network 3</span></span>
<span id="cb5-643"><a href="#cb5-643" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-644"><a href="#cb5-644" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-645"><a href="#cb5-645" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-646"><a href="#cb5-646" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-647"><a href="#cb5-647" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-648"><a href="#cb5-648" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-649"><a href="#cb5-649" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-650"><a href="#cb5-650" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-651"><a href="#cb5-651" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-652"><a href="#cb5-652" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-653"><a href="#cb5-653" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-654"><a href="#cb5-654" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-655"><a href="#cb5-655" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-656"><a href="#cb5-656" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-657"><a href="#cb5-657" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-658"><a href="#cb5-658" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-659"><a href="#cb5-659" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-660"><a href="#cb5-660" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-661"><a href="#cb5-661" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-662"><a href="#cb5-662" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-663"><a href="#cb5-663" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-664"><a href="#cb5-664" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-665"><a href="#cb5-665" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-666"><a href="#cb5-666" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-667"><a href="#cb5-667" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-668"><a href="#cb5-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-669"><a href="#cb5-669" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-670"><a href="#cb5-670" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-671"><a href="#cb5-671" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-672"><a href="#cb5-672" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-673"><a href="#cb5-673" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-674"><a href="#cb5-674" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-675"><a href="#cb5-675" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-676"><a href="#cb5-676" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-677"><a href="#cb5-677" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-678"><a href="#cb5-678" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-679"><a href="#cb5-679" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-680"><a href="#cb5-680" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-681"><a href="#cb5-681" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-682"><a href="#cb5-682" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-683"><a href="#cb5-683" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-684"><a href="#cb5-684" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-685"><a href="#cb5-685" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-686"><a href="#cb5-686" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-687"><a href="#cb5-687" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-688"><a href="#cb5-688" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-689"><a href="#cb5-689" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-690"><a href="#cb5-690" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-691"><a href="#cb5-691" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-692"><a href="#cb5-692" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-693"><a href="#cb5-693" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-694"><a href="#cb5-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-695"><a href="#cb5-695" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-696"><a href="#cb5-696" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-697"><a href="#cb5-697" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-698"><a href="#cb5-698" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-699"><a href="#cb5-699" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-700"><a href="#cb5-700" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-701"><a href="#cb5-701" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-702"><a href="#cb5-702" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-703"><a href="#cb5-703" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-704"><a href="#cb5-704" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-705"><a href="#cb5-705" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-706"><a href="#cb5-706" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-707"><a href="#cb5-707" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-708"><a href="#cb5-708" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-709"><a href="#cb5-709" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-710"><a href="#cb5-710" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-711"><a href="#cb5-711" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-712"><a href="#cb5-712" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-713"><a href="#cb5-713" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-714"><a href="#cb5-714" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-715"><a href="#cb5-715" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-716"><a href="#cb5-716" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-717"><a href="#cb5-717" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-718"><a href="#cb5-718" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-719"><a href="#cb5-719" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-720"><a href="#cb5-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-721"><a href="#cb5-721" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-722"><a href="#cb5-722" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-723"><a href="#cb5-723" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn3Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-724"><a href="#cb5-724" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-725"><a href="#cb5-725" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-726"><a href="#cb5-726" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-727"><a href="#cb5-727" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-728"><a href="#cb5-728" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-729"><a href="#cb5-729" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-730"><a href="#cb5-730" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-731"><a href="#cb5-731" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-732"><a href="#cb5-732" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-733"><a href="#cb5-733" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-734"><a href="#cb5-734" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-735"><a href="#cb5-735" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-736"><a href="#cb5-736" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-737"><a href="#cb5-737" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-738"><a href="#cb5-738" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-739"><a href="#cb5-739" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN3&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-740"><a href="#cb5-740" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-741"><a href="#cb5-741" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-742"><a href="#cb5-742" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-743"><a href="#cb5-743" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-744"><a href="#cb5-744" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-745"><a href="#cb5-745" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-746"><a href="#cb5-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-747"><a href="#cb5-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-748"><a href="#cb5-748" aria-hidden="true" tabindex="-1"></a><span class="do">############ 8. neural network 4</span></span>
<span id="cb5-749"><a href="#cb5-749" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-750"><a href="#cb5-750" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-751"><a href="#cb5-751" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-752"><a href="#cb5-752" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-753"><a href="#cb5-753" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-754"><a href="#cb5-754" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-755"><a href="#cb5-755" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-756"><a href="#cb5-756" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-757"><a href="#cb5-757" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-758"><a href="#cb5-758" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-759"><a href="#cb5-759" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-760"><a href="#cb5-760" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-761"><a href="#cb5-761" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-762"><a href="#cb5-762" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-763"><a href="#cb5-763" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-764"><a href="#cb5-764" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-765"><a href="#cb5-765" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-766"><a href="#cb5-766" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-767"><a href="#cb5-767" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-768"><a href="#cb5-768" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-769"><a href="#cb5-769" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-770"><a href="#cb5-770" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-771"><a href="#cb5-771" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-772"><a href="#cb5-772" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-773"><a href="#cb5-773" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-774"><a href="#cb5-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-775"><a href="#cb5-775" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-776"><a href="#cb5-776" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-777"><a href="#cb5-777" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-778"><a href="#cb5-778" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-779"><a href="#cb5-779" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-780"><a href="#cb5-780" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-781"><a href="#cb5-781" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-782"><a href="#cb5-782" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-783"><a href="#cb5-783" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-784"><a href="#cb5-784" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-785"><a href="#cb5-785" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-786"><a href="#cb5-786" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-787"><a href="#cb5-787" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-788"><a href="#cb5-788" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-789"><a href="#cb5-789" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-790"><a href="#cb5-790" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-791"><a href="#cb5-791" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-792"><a href="#cb5-792" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-793"><a href="#cb5-793" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-794"><a href="#cb5-794" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-795"><a href="#cb5-795" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-796"><a href="#cb5-796" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-797"><a href="#cb5-797" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-798"><a href="#cb5-798" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-799"><a href="#cb5-799" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-800"><a href="#cb5-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-801"><a href="#cb5-801" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-802"><a href="#cb5-802" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-803"><a href="#cb5-803" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-804"><a href="#cb5-804" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-805"><a href="#cb5-805" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-806"><a href="#cb5-806" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-807"><a href="#cb5-807" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-808"><a href="#cb5-808" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-809"><a href="#cb5-809" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-810"><a href="#cb5-810" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-811"><a href="#cb5-811" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-812"><a href="#cb5-812" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-813"><a href="#cb5-813" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-814"><a href="#cb5-814" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-815"><a href="#cb5-815" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-816"><a href="#cb5-816" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-817"><a href="#cb5-817" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-818"><a href="#cb5-818" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-819"><a href="#cb5-819" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-820"><a href="#cb5-820" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-821"><a href="#cb5-821" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-822"><a href="#cb5-822" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-823"><a href="#cb5-823" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-824"><a href="#cb5-824" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-825"><a href="#cb5-825" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-826"><a href="#cb5-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-827"><a href="#cb5-827" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-828"><a href="#cb5-828" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-829"><a href="#cb5-829" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn4Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-830"><a href="#cb5-830" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-831"><a href="#cb5-831" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-832"><a href="#cb5-832" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-833"><a href="#cb5-833" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-834"><a href="#cb5-834" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-835"><a href="#cb5-835" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-836"><a href="#cb5-836" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-837"><a href="#cb5-837" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-838"><a href="#cb5-838" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-839"><a href="#cb5-839" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-840"><a href="#cb5-840" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-841"><a href="#cb5-841" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-842"><a href="#cb5-842" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-843"><a href="#cb5-843" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-844"><a href="#cb5-844" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-845"><a href="#cb5-845" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN4&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-846"><a href="#cb5-846" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-847"><a href="#cb5-847" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-848"><a href="#cb5-848" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-849"><a href="#cb5-849" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-850"><a href="#cb5-850" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-851"><a href="#cb5-851" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-852"><a href="#cb5-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-853"><a href="#cb5-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-854"><a href="#cb5-854" aria-hidden="true" tabindex="-1"></a><span class="do">############ 9. neural network 5</span></span>
<span id="cb5-855"><a href="#cb5-855" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - big firms--------------</span></span>
<span id="cb5-856"><a href="#cb5-856" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-857"><a href="#cb5-857" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-858"><a href="#cb5-858" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-859"><a href="#cb5-859" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-860"><a href="#cb5-860" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-861"><a href="#cb5-861" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-862"><a href="#cb5-862" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-863"><a href="#cb5-863" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-864"><a href="#cb5-864" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-865"><a href="#cb5-865" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-866"><a href="#cb5-866" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-867"><a href="#cb5-867" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-868"><a href="#cb5-868" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-869"><a href="#cb5-869" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-870"><a href="#cb5-870" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-871"><a href="#cb5-871" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-872"><a href="#cb5-872" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-873"><a href="#cb5-873" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-874"><a href="#cb5-874" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-875"><a href="#cb5-875" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-876"><a href="#cb5-876" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-877"><a href="#cb5-877" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-878"><a href="#cb5-878" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-879"><a href="#cb5-879" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-880"><a href="#cb5-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-881"><a href="#cb5-881" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Realized volatility - small firms--------------</span></span>
<span id="cb5-882"><a href="#cb5-882" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-883"><a href="#cb5-883" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Real.Vol<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-884"><a href="#cb5-884" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-885"><a href="#cb5-885" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-886"><a href="#cb5-886" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-887"><a href="#cb5-887" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-888"><a href="#cb5-888" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-889"><a href="#cb5-889" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-890"><a href="#cb5-890" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-891"><a href="#cb5-891" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-892"><a href="#cb5-892" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-893"><a href="#cb5-893" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-894"><a href="#cb5-894" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-895"><a href="#cb5-895" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-896"><a href="#cb5-896" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-897"><a href="#cb5-897" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-898"><a href="#cb5-898" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-899"><a href="#cb5-899" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-900"><a href="#cb5-900" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-901"><a href="#cb5-901" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-902"><a href="#cb5-902" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-903"><a href="#cb5-903" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-904"><a href="#cb5-904" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-905"><a href="#cb5-905" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-906"><a href="#cb5-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-907"><a href="#cb5-907" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - Large firms--------------</span></span>
<span id="cb5-908"><a href="#cb5-908" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-909"><a href="#cb5-909" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Big<span class="sc">$</span>CE)</span>
<span id="cb5-910"><a href="#cb5-910" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-911"><a href="#cb5-911" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-912"><a href="#cb5-912" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-913"><a href="#cb5-913" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-914"><a href="#cb5-914" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-915"><a href="#cb5-915" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-916"><a href="#cb5-916" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-917"><a href="#cb5-917" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-918"><a href="#cb5-918" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-919"><a href="#cb5-919" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-920"><a href="#cb5-920" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-921"><a href="#cb5-921" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-922"><a href="#cb5-922" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-923"><a href="#cb5-923" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-924"><a href="#cb5-924" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-925"><a href="#cb5-925" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-926"><a href="#cb5-926" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-927"><a href="#cb5-927" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-928"><a href="#cb5-928" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-929"><a href="#cb5-929" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-930"><a href="#cb5-930" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-931"><a href="#cb5-931" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-932"><a href="#cb5-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-933"><a href="#cb5-933" aria-hidden="true" tabindex="-1"></a><span class="co">#------- Kurtosis - small firms--------------</span></span>
<span id="cb5-934"><a href="#cb5-934" aria-hidden="true" tabindex="-1"></a>noCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span><span class="st">`</span><span class="at">No CE</span><span class="st">`</span>)</span>
<span id="cb5-935"><a href="#cb5-935" aria-hidden="true" tabindex="-1"></a>withCE <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nn5Res<span class="sc">$</span>Kurtosis<span class="sc">$</span>Small<span class="sc">$</span>CE)</span>
<span id="cb5-936"><a href="#cb5-936" aria-hidden="true" tabindex="-1"></a>rocNoCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-937"><a href="#cb5-937" aria-hidden="true" tabindex="-1"></a>rocNoCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-938"><a href="#cb5-938" aria-hidden="true" tabindex="-1"></a>rocNoCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(noCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(noCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-939"><a href="#cb5-939" aria-hidden="true" tabindex="-1"></a>rocWithCE_neg <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;-1&#39;</span>, <span class="st">&#39;negative&#39;</span>,<span class="st">&#39;non-negative&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">-1</span><span class="st">`</span>))</span>
<span id="cb5-940"><a href="#cb5-940" aria-hidden="true" tabindex="-1"></a>rocWithCE_neu <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;0&#39;</span>, <span class="st">&#39;neutral&#39;</span>,<span class="st">&#39;non-neutral&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>))</span>
<span id="cb5-941"><a href="#cb5-941" aria-hidden="true" tabindex="-1"></a>rocWithCE_pos <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> <span class="fu">ifelse</span>(withCE<span class="sc">$</span>Actual<span class="sc">==</span><span class="st">&#39;1&#39;</span>, <span class="st">&#39;positive&#39;</span>,<span class="st">&#39;non-positive&#39;</span>), <span class="at">predictor =</span> <span class="fu">as.numeric</span>(withCE<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>))</span>
<span id="cb5-942"><a href="#cb5-942" aria-hidden="true" tabindex="-1"></a><span class="do">##without cross effect each ROC curve</span></span>
<span id="cb5-943"><a href="#cb5-943" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-944"><a href="#cb5-944" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">xacol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-945"><a href="#cb5-945" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocNoCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-946"><a href="#cb5-946" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-947"><a href="#cb5-947" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-948"><a href="#cb5-948" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-949"><a href="#cb5-949" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocNoCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb5-950"><a href="#cb5-950" aria-hidden="true" tabindex="-1"></a><span class="do">##with cross effect each ROC curve</span></span>
<span id="cb5-951"><a href="#cb5-951" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neg, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">legacy.axes =</span> T, <span class="at">main =</span> <span class="st">&quot;NN5&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-952"><a href="#cb5-952" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_neu, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-953"><a href="#cb5-953" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocWithCE_pos, <span class="at">legacy.axes =</span> T, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb5-954"><a href="#cb5-954" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">pos=</span><span class="sc">-</span><span class="fl">0.04</span>)</span>
<span id="cb5-955"><a href="#cb5-955" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (negative) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neg),<span class="dv">3</span>)),</span>
<span id="cb5-956"><a href="#cb5-956" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (neutral) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_neu),<span class="dv">3</span>)),</span>
<span id="cb5-957"><a href="#cb5-957" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;AUC (positive) =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(rocWithCE_pos),<span class="dv">3</span>))), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
